<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" class="k-webkit k-webkit24">
	<head>
		<title>Kgwerano TrustMaster Fleet| Maintenance History</title>
	</head>
	<body>
		<div id="mainWrap" data-role="view" data-layout="fleetdashboardLayout" data-title="OPERATIONS" data-before-show="cleanview">
			<div id="dashboard">
				<div class="demo-section">
					<div class="company-info" id="Fleet">
						<dl class="stat first">
							<dt class="dashboard-subtitle1">
								TOTAL EXPENDITURE
							</dt>
							<dl class="stat trend-container_first">
								<dt class="dashboard-subtitle">Last Year</dt><span class="metric" id="lblexpnlastyearDate">(01/02/2012)</span>
								<dd class="volumeMedium" id="lblexplastYear" ></dd>
							</dl>
							<!--<dl class="stat trend-container"></dl>-->
							<dl class="stat trend-container">
								<dt class="dashboard-subtitle">
									Previous Month<span class="metric" id="lblexpnprevmonthDate" >(01/01/2013)</span>
								</dt>
								<dd class="volumeMedium" id="lblexpnpreMonth">215234.67</dd>
							</dl>

						</dl>
						<div class="company-trends">
							<dl class="stat first">
								<span class="metric_right" id="lblexpncurrDate" >(01/02/2013)</span>
								<dt class="dashboard-subtitle-right">Date</dt>
								<dd class="volumeBig" id="lblexpncurrentDate">334556.33</dd>
							</dl>
						</div>
						<div class="separator"></div>
					</div>
					<br/>
					<dt class="dashboard-subtitle1">MONTHLY EXPENDITURE PER CATEGORY </dt>
					<div id="Barchart"></div>
					<div class="company-info" id="google">
						<div class="separator"></div>
						<dl class="stat first">
							<dt class="dashboard-subtitle1">
								FLEET SIZE
							</dt>
							<br/>
							<dt class="dashboard-subtitle">
								Date<span class="metric" id="lblfleetcurDate" >(01/02/2013)</span>
							</dt>
							<dd class="volumeBig" id="currentFleet" >16,000</dd>
								
							<dt class="dashboard-subtitle">
								Previous Month<span class="metric" id="lblfleetprevmonthDate" >(01/01/2013)</span>
							</dt>
							<dd class="volumeMedium" id="prevFleet">14,000</dd>
								
							<dt class="dashboard-subtitle">
								Last Year<span class="metric" id="lblfleetlastyearDate" >(01/02/2012)</span>
							</dt>
							<dd class="volumeMedium" id="lastyearFleet" >12,000</dd>
								
						</dl>
						<div class="volume-chart k-chart" >
							<div id="chart" ></div>
                            <script>
							$(document).ready(function () {
                               
								var temp = ((callwebservice('fleet', 'getexpenditures').dataSource));  
                                
								//Dashboard Numeric Display
                                
								$("#lblexplastYear").html(temp.data[2].LastYearExpenditure);
								$("#lblexpnpreMonth").html(temp.data[1].PrevioudMonthExpenditure);
								$("#lblexpncurrentDate").html(temp.data[0].TotalExpenditure);
								$("#currentFleet").html(temp.data[3].FleetSize);
								$("#prevFleet").html(temp.data[4].PrevMonthFleetSize);
								$("#lastyearFleet").html(temp.data[5].FleetSizeLastYear);
                                
								//Dasboard Date Display
                                
								$("#lblexpnlastyearDate").html(temp.data[2].Date);
								$("#lblexpnprevmonthDate").html(temp.data[1].Date);
								$("#lblexpncurrDate").html(temp.data[0].Date);
								$("#lblfleetcurDate").html(temp.data[3].Date);
								$("#lblfleetprevmonthDate").html(temp.data[4].Date);
								$("lblfleetlastyearDate").html(temp.data[5].Date);
                                
								setTimeout(function () {
									// Initialize the chart with a delay to make sure
									// the initial animation is visible
									createBarChart();
									createLineChart();
							
									$("#dashboard").bind("kendo:skinChange", function (e) {
										createBarChart();
										createLineChart();
									});                   
								}, 400);
							});
							
							</script>
							<script>
                                 debugger;
                                //read barchart data from servcie
                                var barchartData = ((callwebservice('fleet', 'GetExpendituresByCategory').dataSource));  
                                
								var internetUsers = [
									{
										"country": "Fleet",
										"year": "JUL-12",
										"value": 7000
									},{
										"country": "Fleet",
										"year": "AUG-12",
										"value": 6000
									},{
										"country": "Fleet",
										"year": "SEP-12",
										"value": 4000
									},{
										"country": "Fleet",
										"year": "OCT-12",
										"value": 9000
									},{
										"country": "Fleet",
										"year": "DEC-12",
										"value": 10000
									},{
										"country": "Fleet",
										"year": "JAN-13",
										"value": 10000
									}
								];
								
								function createLineChart() {
									$("#chart").kendoChart({
										theme: "blueopal",
										dataSource: {
											data: internetUsers
										},
								
										legend: {
											visible: false
										},
										seriesDefaults: {
											type: "line",
											labels: {
												visible: false,
												format: "{0}"
											}
										},
										series: [
											{
												field: "value",
												name: "Fleet"
											}
										],
										valueAxis: {
											labels: {
												format: "{0}"
											},
											majorUnit: 2000
										},
										chartArea:{
											height:300, width:500,background: ""
								
										},
										categoryAxis: {
											field: "year"
										}
									});
								}
								
								function createBarChart() {
									$("#Barchart").kendoChart({
										theme: "blueopal",
								
										legend: {
											position: "top",
											offsetX: 240
								
										},
										seriesDefaults: {
											type: "column"
										},
										series: [
											{
												name: "Prev. Month same date",
												data: barchartData.data1
											}, {
												name: "Current Month",
												data: barchartData.data2
											}
										],
										valueAxis: {
											labels: {
												format: "{0}"
											}
											
										},
										categoryAxis: {
											categories: barchartData.data3,
											labels: {
												rotation: -30,
												margin: 0,
												padding: { top: 0, left: 10, right :50 }
											},
                                            baseUnit : "fit"
										},
										chartArea:{
											width:750,
											height :340,
											background: ""
										},
										tooltip: {
											visible: true,
											format: "{0}"
										}
									});
								}								
							</script>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>